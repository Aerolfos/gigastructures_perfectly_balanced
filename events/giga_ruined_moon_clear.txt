namespace = giga_ruined_moon_clear

### On game start
event = {
	id = giga_ruined_moon_clear.001
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		event_target:global_event_country = {
			country_event = { id = giga_ruined_moon_clear.002 days = 5 }
		}
	}
}

### Delayed by 5 days
country_event = {
	id = giga_ruined_moon_clear.002
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = { has_global_flag = giga_game_started }
			if = {
				limit = { any_system = { has_star_flag = war_moon_planet_here } } # skips events if you disabled moon/planet completely, no debris exists
				every_system = {
					limit = {
						has_star_flag = war_moon_planet_here
					}
					every_system_megastructure = {
						limit = {
							OR = {
								is_megastructure_type = war_moon_debris_cold_barren
								is_megastructure_type = war_moon_debris_barren
								is_megastructure_type = war_moon_debris_molten
								is_megastructure_type = war_moon_debris_luna
								is_megastructure_type = war_moon_debris_disco
								is_megastructure_type = war_moon_debris_frozen
								is_megastructure_type = war_planet_debris
							}
						}
						remove_megastructure = this
					}
				}
			}
		}
		# fallback
		else = {
			country_event = { id = giga_ruined_moon_clear.003 days = 200 }
		}
	}
}

### Delayed by 200 days, fallback event for starting the game timer without setting up the gigas settings (shame on you!)
country_event = {
	id = giga_ruined_moon_clear.003
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = { any_system = { has_star_flag = war_moon_planet_here } } # skips events if you disabled moon/planet completely, no debris exists
			every_system = {
				limit = {
					has_star_flag = war_moon_planet_here
				}
				every_system_megastructure = {
					limit = {
						OR = {
							is_megastructure_type = war_moon_debris_cold_barren
							is_megastructure_type = war_moon_debris_barren
							is_megastructure_type = war_moon_debris_molten
							is_megastructure_type = war_moon_debris_luna
							is_megastructure_type = war_moon_debris_disco
							is_megastructure_type = war_moon_debris_frozen
							is_megastructure_type = war_planet_debris
						}
					}
					remove_megastructure = this
				}
			}
		}
	}
}